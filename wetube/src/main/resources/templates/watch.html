<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout.html}">
<head>
<meta charset="UTF-8">
<title>Wetube</title>
<link rel="stylesheet" href="/css/tap.css">
<style>
/* ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒì„ ì‚¬ìš©í•˜ì—¬ ë¹„ë””ì˜¤ì™€ íƒ­ ë°°ì¹˜ */
.video-tabs-container {
	display: grid;
	grid-template-columns: 70% 30%; /* ë¹„ë””ì˜¤ 70%, íƒ­ 30% */
	gap: 20px; /* ë¹„ë””ì˜¤ì™€ íƒ­ ì‚¬ì´ ê°„ê²© */
}

/* ë¹„ë””ì˜¤ ì»¨í…Œì´ë„ˆ */
.video-container {
	width: 100%;
	max-width: 1200px; /* ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
	padding: 10px;
	margin-left: 50px;
	box-sizing: border-box;
}

/* íƒ­ ì˜ì—­ */
.videos {
	width: 100%;
	margin-left: 30px;
}

/* ë°˜ì‘í˜• ë¹„ë””ì˜¤ ìŠ¤íƒ€ì¼ */
video {
	width: 100%;
	height: auto;
	border-radius: 8px;
	border: 1px solid #ddd;
}
    /* ê´‘ê³  ê°ì‹¸ëŠ” ì»¨í…Œì´ë„ˆ */
    .ad-wrapper {
        position: relative;
        display: inline-block;
        width: 100%;
    }

    /* ê´‘ê³ ìš© ë¹„ë””ì˜¤ */
    .ad-video {
        width: 100%;
        height: auto;
    }

    /* ìœ íŠœë¸Œ ìŠ¤íƒ€ì¼ ìŠ¤í‚µ ë²„íŠ¼ */
    .skip-ad-btn {
        position: absolute;
        bottom: 20px;
        right: 20px;
        padding: 10px 15px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px;
        transition: 0.3s;
    }

    .skip-ad-btn:hover {
        background: rgba(0, 0, 0, 0.9);
    }
/* ë¯¸ë””ì–´ ì¿¼ë¦¬ë¥¼ ì´ìš©í•œ ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ */
@media ( max-width : 768px) {
	.video-tabs-container {
		grid-template-columns: 100%; /* í™”ë©´ í¬ê¸°ê°€ ì‘ì•„ì§€ë©´ ë¹„ë””ì˜¤ì™€ íƒ­ì´ ì„¸ë¡œë¡œ ë‚˜ì—´ë¨ */
	}
	.videos {
		margin-top: 20px; /* ë¹„ë””ì˜¤ ì•„ë˜ë¡œ íƒ­ ë°°ì¹˜ */
	}
}
.video-thumbnail-container {
	position: relative;
	display: inline-block;
	width: 168px;
	height: 94px;
	overflow: hidden;
	margin-bottom: -20px;
	margin-top: 20px;
}

.video-thumbnail-container:hover {
	cursor: pointer;
}

.video-thumbnail-container video {
	width: 100%;
	height: 100%;
	object-fit: cover;
	border: none;
}

@media ( max-width : 768px) {
	.video-thumbnail-container {
		width: 140px;
		height: 78px;
	}
}

/* ë¹„ë””ì˜¤ ì¬ìƒ ì‹œê°„ í‘œì‹œ */
.video-duration {
	position: absolute;
	bottom: 8px;
	right: 8px;
	background-color: rgba(0, 0, 0, 0.7);
	color: #fff;
	font-size: 12px;
	padding: 2px 6px;
	border-radius: 4px;
}

.details {
	display: inline-block;
	margin-left: 5px;
}

.videos-title-container {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-bottom: 16px;
}

.videos-title {
	margin: 0;
	font-family: Roboto, Arial, sans-serif;
	font-size: 14px;
	font-weight: 500;
	
}

.videos-icon {
	margin: 5px 0 0 70px;
	font-size: 16px;
	cursor: pointer;
	color: #555;
}

.videos-UserName {
	font-family: Roboto, Arial, sans-serif;
	font-size: 12px;
	font-weight: 400;
	margin: 0;
}

.vidoes-UserHit {
	font-family: Roboto, Arial, sans-serif;
	font-size: 12px;
	font-weight: 400;
}

.watch-title {
	font-family: Roboto, Arial, sans-serif;
	font-size: 20px;
	font-weight: 700;
	color:#0F0F0F;
}

.watch-content {
    display: flex;
    justify-content: space-between; /* ìš”ì†Œë“¤ì´ ì–‘ìª½ ëì— ë°°ì¹˜ë˜ë„ë¡ í•¨ */
	margin-top: 20px;
}

.profile-container {
	display: flex;
	align-items: center;
	width: 360px;
	height: 44px;
}
.profile-container img:hover{
	cursor: pointer;
}
.watch-UserName:hover{
	cursor: pointer;
}
.profile-image {
	width: 40px;
	height: 40px;
	border-radius: 50%;
	margin-right: 10px;
}

.profile-info {
	margin: 15px 24px 0 0; 
}
.watch-UserName{
	font-family: Roboto, Arial, sans-serif;
	font-size: 16px;
	font-weight: 500;
	margin: 0;
	width: 93px;
	height: 22px;
	color:#0F0F0F;
}
.subscriber-count {
	font-size: 14px;
	color: #555;
	width: 87px;
	height: 18px;
}

.subscribe-btn {
	background-color: #ff0000;
	color: white;
	border: none;
	padding: 5px 15px;
	border-radius: 3px;
	cursor: pointer;
}

.like-dislike-btns {
  display: flex;
  align-items: center;
  font-family: Roboto, Arial, sans-serif;
  font-size: 16px;
  font-weight: 500;
  color: rgb(15, 15, 15);
  width: 400px;
  height: 45px;
  justify-content: flex-end; /* ì˜¤ë¥¸ìª½ ì •ë ¬ ì¶”ê°€ */
  transform: translateX(450px); /* 10px ë§Œí¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ */
}

.like-dislike-btns i {
  cursor: pointer;
  margin-right: 10px;
}

.likes-count {
  margin-right: 10px;
}

.share-save-btn {
  margin-right: 10px;
}

/* Adding responsiveness for smaller screens */
@media (max-width: 768px) {
  .like-dislike-btns {
    justify-content: center;
    margin-top: 10px;
  }
}

.video-details {
	margin-top: 20px;
	font-size: 14px;
	color: #777;
	background: #F2F2F2;
	width: 1180px;
	height: 135px;
	padding: 20px;
    border-radius: 3%; 
    min-height: 135px; /* ìµœì†Œ ë†’ì´ */
}

.date {
	font-size: 12px;
	color: #999;
}
.watch-videos{
    background-attachment: scroll;
    background-clip: border-box;
    background-color: rgba(0, 0, 0, 0);
    background-image: none;
    background-origin: padding-box;
    background-position-x: 0%;
    background-position-y: 0%;
    background-repeat: repeat;
    background-size: auto;
    border-bottom-color: rgb(0, 0, 0);
    border-bottom-style: none;
    border-bottom-width: 0px;
    border-image-outset: 0;
    border-image-repeat: stretch;
    border-image-slice: 100%;
    border-image-source: none;
    border-image-width: 1;
    border-left-color: rgb(0, 0, 0);
    border-left-style: none;
    border-left-width: 0px;
    border-right-color: rgb(0, 0, 0);
    border-right-style: none;
    border-right-width: 0px;
    border-top-color: rgb(0, 0, 0);
    border-top-style: none;
    border-top-width: 0px;
    display: block;
    font-family: Roboto, Arial, sans-serif;
    font-size: 10px;
    height: 3809.62px;
    margin-bottom: 0px;
    margin-left: 60px;
    margin-right: 0px;
    margin-top: 0px;
    padding-bottom: 0px;
    padding-left: 0px;
    padding-right: 0px;
    padding-top: 0px;
    scrollbar-color: rgb(96, 96, 96) rgba(0, 0, 0, 0);
    text-size-adjust: 100%;
    unicode-bidi: isolate;
    width: 730px;
}
.wt-bl{
 background-color: #F2F2F2;
  border: none;
  border-radius: 30px 0 0 30px;
  padding: 10px;
}
.wt-bl:hover{
 background-color: #D5D5D5;
 cursor: pointer;
}
.wt-bl-rt:hover{
 background-color: #D5D5D5;
 cursor: pointer;
}
.wt-bl-rt{
 background-color: #F2F2F2;
  border: none;
  border-radius: 0 30px 30px 0 ;
  padding: 10px;
}
.wt-bl-save{
 margin-left: 15px;	
 background-color: #F2F2F2;
  border: none;
  border-radius: 30%; 
   padding: 10px;
}
.wt-bl-save:hover{
 background-color: #D5D5D5;
 cursor: pointer;
}
.wt-bl-share{
 margin-left: 15px;	
 background-color: #F2F2F2;
  border: none;
  border-radius: 30%; 
   padding: 10px;
}
.wt-bl-share:hover{
 background-color: #D5D5D5;
 cursor: pointer;
}
.description {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
  line-clamp: 2; /* ë‘ ì¤„ê¹Œì§€ë§Œ í‘œì‹œ */
  -webkit-line-clamp: 2; /* ì›¹í‚· ë¸Œë¼ìš°ì € í˜¸í™˜ */
  white-space: normal;
}
/*ë¬¸ì¥ì´ ê¸¸ì–´ì§€ë©´ ...ìœ¼ë¡œ ì˜ë¼ì¤Œ*/
.ellipsis { 
  overflow: hidden;
  text-overflow: ellipsis;
  white-space:nowrap;
  width: 800px;
  height: 30px;
}
/*ëŒ“ê¸€ ìŠ¤íƒ€ì¼ ë¶€ë¶„*/
    .comments-container {
      display: flex; /* Flexbox ì ìš©ìœ¼ë¡œ ê°€ë¡œ ì •ë ¬ */
      align-items: center; /* ì„¸ë¡œì¶• ì¤‘ì•™ ì •ë ¬ */
      gap: 10px; /* ìš”ì†Œ ê°„ ê°„ê²© */
      margin-top: 20px;
    }

    .comments-count {
      font-family: Roboto, Arial, sans-serif;
      font-size: 20px;
      font-weight: 700;
      display: inline-block; /* inline ëŒ€ì‹  inline-block ì‚¬ìš© */
      width: 120px;
      height: 28px;
      text-align: left; /* í…ìŠ¤íŠ¸ ì™¼ìª½ ì •ë ¬ */
    }

    .comments-sorting {
      width: 120px;
      height: 28px; /* ë™ì¼í•œ ë†’ì´ë¡œ ë§ì¶¤ */
      display: inline-block;
      text-align: center;
      line-height: 28px; /* ë†’ì´ì™€ ê°™ì€ ê°’ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ê°€ìš´ë° ì •ë ¬ */
    }
    .comments-sorting:hover {
    cursor: pointer;
    }
    .comments-font{
    font-family: Roboto, Arial, sans-serif;
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 30px;
    display: inline-block;
    transform: translateY(-15px) translateX(10px); /* ìœ„ë¡œ 10px ì´ë™ */
    }
.comments-profile-container {
  display: flex;
  align-items: center; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
  gap: 10px; /* í”„ë¡œí•„ ì´ë¯¸ì§€ì™€ ì…ë ¥ì°½ ê°„ì˜ ê°„ê²© */
  margin-top: 20px;
  width: 100%; /* ì „ì²´ í™”ë©´ì— ë§ê²Œ */
  max-width: 1180px; /* ìµœëŒ€ ë„ˆë¹„ ì œí•œ */
  margin-left: auto;
  margin-right: auto; /* ì¤‘ì•™ ì •ë ¬ */
  box-sizing: border-box; /* íŒ¨ë”© í¬í•¨ */
}

.profile-image {
  width: 40px; /* í”„ë¡œí•„ ì´ë¯¸ì§€ í¬ê¸° */
  height: 40px;
  border-radius: 50%; /* ì›í˜•ìœ¼ë¡œ ë§Œë“¤ê¸° */
  object-fit: cover; /* ì´ë¯¸ì§€ë¥¼ ë¹„ìœ¨ ë§ì¶”ì–´ ì˜ë¦¼ ì—†ì´ í‘œì‹œ */
}

.comment-input {
  flex-grow: 1; /* ì…ë ¥ì°½ì´ ë‚¨ì€ ê³µê°„ì„ ì±„ìš°ë„ë¡ ì„¤ì • */
  padding: 8px 12px;
  border: 1px solid #ccc;
  border-radius: 20px;
  font-size: 14px;
  min-width: 0; /* ë„ˆë¬´ ì‘ì€ í™”ë©´ì—ì„œë„ ìš”ì†Œê°€ ì˜ë¦¬ì§€ ì•Šê²Œ ì„¤ì • */
  width: 500px;
}

.comment-submit-btn {
  padding: 8px 16px;
  background-color: #007bff;
  color: white;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  font-size: 14px;
  white-space: nowrap; /* í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ë°©ì§€ */
}

.comment-submit-btn:hover {
  background-color: #0056b3;
}

/* ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ ì¡°ì • */
@media (max-width: 768px) {
  .profile-image {
    width: 35px;
    height: 35px; /* í”„ë¡œí•„ ì´ë¯¸ì§€ í¬ê¸° ì¶•ì†Œ */
  }

  .comment-input {
    font-size: 13px; /* ì…ë ¥ì°½ ê¸€ì í¬ê¸° ì¶•ì†Œ */
    padding: 6px 10px;
  }

  .comment-submit-btn {
    font-size: 13px; /* ë²„íŠ¼ ê¸€ì í¬ê¸° ì¶•ì†Œ */
    padding: 6px 12px;
  }
}

@media (max-width: 480px) {
  .profile-image {
    width: 30px;
    height: 30px; /* ë” ì‘ì€ í™”ë©´ì—ì„œëŠ” ë” ì‘ê²Œ */
  }

  .comment-input {
    font-size: 12px;
    padding: 5px 8px; /* ì…ë ¥ì°½ í¬ê¸° ì¤„ì„ */
  }

  .comment-submit-btn {
    font-size: 12px;
    padding: 5px 10px; /* ë²„íŠ¼ í¬ê¸° ì¤„ì„ */
  }
}

/* ëŒ“ê¸€ ë°•ìŠ¤ */
.comments-profile-content {
  display: flex;
  align-items: flex-start;
  margin-top: 40px;
  margin-bottom: 20px;
  padding: 10px;
  background-color: #fff;
  border: 1px solid #ddd;
  border-radius: 8px;
  width: 1180px;
  flex-shrink: 0; /* flexì—ì„œ ë„ˆë¹„ ë³€ê²½ ë°©ì§€ */
  box-sizing: border-box; /* íŒ¨ë”©, í…Œë‘ë¦¬ë¥¼ í¬í•¨í•œ ë„ˆë¹„ ê³„ì‚° */
}

.profile-image {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  margin-right: 15px;
}

.comment-content {
  flex: 1;
}

.comment-author {
  font-weight: bold;
  margin-bottom: 5px;
  color: #333;
}

.comment-text {
  margin: 0;
  color: #555;
  font-size: 14px;
}

.comment-actions {
  margin-top: 10px;
}

.action-button {
  background: none;
  border: none;
  color: #555;
  font-size: 14px;
  cursor: pointer;
  margin-right: 10px;
  display: inline-flex;
  align-items: center;
}

.action-button i {
  margin-right: 5px;
}

.action-button:hover {
  color: #000;
}

.comments-icon {
  color: #aaa;
  font-size: 18px;
  margin-left: 10px;
  cursor: pointer;
}

.comments-icon:hover {
  color: #000;
}

/* ëŒ“ê¸€ ë°˜ì‘í˜• ë„ˆë¹„ ì¡°ì • */
@media (max-width: 768px) {
  .comments-profile-content {
    width: 95%; /* íƒœë¸”ë¦¿ í™”ë©´ì—ì„œëŠ” ë„ˆë¹„ ì¡°ì • */
    font-size: 13px; /* í…ìŠ¤íŠ¸ í¬ê¸° ì¶•ì†Œ */
  }
  .comment-text {
    font-size: 13px; /* ê¸€ì í¬ê¸° ì¶•ì†Œ */
  }
}

@media (max-width: 480px) {
  .comments-profile-content {
    width: 100%; /* ì‘ì€ í™”ë©´ì—ì„œëŠ” ì „ì²´ ë„ˆë¹„ */
    padding: 8px; /* íŒ¨ë”© ì¶•ì†Œ */
    font-size: 12px; /* ê¸€ì í¬ê¸° ì¶•ì†Œ */
  }
  .comment-text {
    font-size: 12px; /* ëŒ“ê¸€ í…ìŠ¤íŠ¸ í¬ê¸° ì¤„ì„ */
  }
}

@media (max-width: 768px) {
  .watch-title {
   display: none; /* í™”ë©´ í¬ê¸°ê°€ ì‘ì•„ì§€ë©´ ìˆ¨ê¹€ */
  }
}
@media (max-width: 768px) {
  .watch-content {
   display: none; /* í™”ë©´ í¬ê¸°ê°€ ì‘ì•„ì§€ë©´ ìˆ¨ê¹€ */
  }
}
@media (max-width: 768px) {
  .video-details {
   display: none; /* í™”ë©´ í¬ê¸°ê°€ ì‘ì•„ì§€ë©´ ìˆ¨ê¹€ */
  }
}
/*ëŒ“ê¸€ í´ë¦­ ìŠ¤íƒ€ì¼ ë¶€ë¶„*/
/* ëŒ“ê¸€ ë©”ë‰´ */
.comment-menu {
  display: none; /* ì²˜ìŒì—ëŠ” ìˆ¨ê¹€ */
  position: absolute;
  background: white;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 10px;
  box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
  width: 130px;
}

/* ë©”ë‰´ í•­ëª© */
.comment-menu-item {
  display: flex;
  flex-direction: column; /* í•­ëª©ì„ ì„¸ë¡œë¡œ ì •ë ¬ */
  gap: 7px; /* í•­ëª© ê°„ ê°„ê²© */
  cursor: pointer;
  font-size: 14px;
  font-family: Arial, sans-serif;
  border-radius: 4px;
}

/* ìˆ˜ì •, ì‚­ì œ ë²„íŠ¼ */
.comment-menu-item button {
  background: none;
  border: none;
  padding: 10px 16px;
  text-align: left;
  cursor: pointer;
  font-size: 14px;
  width: 100%;
}

.comment-menu-item button:hover {
  background: rgba(0, 0, 0, 0.05); /* í˜¸ë²„ íš¨ê³¼ */
}

/* ìˆ˜ì • ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.edit-btn {
  border-bottom: 1px solid rgba(0, 0, 0, 0.1); /* êµ¬ë¶„ì„  */
}

/* ì‚­ì œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.delete-btn {
  color: red; /* ë¹¨ê°„ìƒ‰ */
}

</style>

<script type="text/javascript">
document.addEventListener('DOMContentLoaded', () => {
	  // ëŒ“ê¸€ ê´€ë ¨ ê¸°ëŠ¥
	  const commentInput = document.querySelector('.comment-input');
	  const commentSubmitBtn = document.querySelector('.comment-submit-btn');
	  const commentsList = document.getElementById('comments-list');
	  const userNickname = document.getElementById('user-nickname').value;  // ë‹‰ë„¤ì„ ê°€ì ¸ì˜¤ê¸°
	  const wetubeId = document.getElementById('user-wetubeId').value;
	  const userProfile = document.querySelector('.profile-image').src; // í”„ë¡œí•„ ì´ë¯¸ì§€ URL ê°€ì ¸ì˜¤ê¸°
	  const commentCountElement = document.querySelector('.comments-count'); // ëŒ“ê¸€ ê°œìˆ˜ë¥¼ í‘œì‹œí•˜ëŠ” ìš”ì†Œ
	  
	  const userIdElement = document.querySelector(".userId"); // í´ë˜ìŠ¤ ì´ë¦„ ì‚¬ìš©
	  const userId = userIdElement ? userIdElement.getAttribute("data-user-id") : null;
	  // ëŒ“ê¸€ ë¡œë“œ
	  function loadComments() {
	    if (!wetubeId) {
	      console.error('wetubeId ê°’ì´ ì—†ìŠµë‹ˆë‹¤.');
	      return;
	    }

	    fetch(`/comments/list?id=${wetubeId}`)
	      .then((res) => res.json())
	      .then((data) => {
	        commentCountElement.textContent = `ëŒ“ê¸€ ${data.length}ê°œ`;
	        commentsList.innerHTML = ''; // ê¸°ì¡´ ëŒ“ê¸€ ë‚´ìš© ì´ˆê¸°í™”
	        data.forEach((comment) => {
	          const commentHTML = `
	            <div class="comments-profile-content" data-comment-id="${comment.commentId}"  data-comment-userid="${comment.userId}">
	              <img src="${comment.profileImage}" alt="Profile" class="profile-image">
	              <div class="comment-content">
	                <p class="comment-author">@${comment.nickName}</p>
	                <p class="comment-text">${comment.body}</p>
	                <div class="comment-actions">
	                  <button class="action-button like-btn" data-liked="${comment.liked}">
	                    <i class="fa fa-thumbs-up"></i> 
	                    <span class="like-count">${comment.commentLikes}</span>
	                  </button>
	                  <button class="action-button dislike-btn">
	                    <i class="fa fa-thumbs-down"></i>
	                  </button>
	                </div>
	              </div>
	              <div class="comment-menu-container" style="position: relative;">
	              <i class="fa fa-ellipsis-v videos-icon comments-icon"></i>
	              <div class="comment-menu" data-comment-id="${comment.commentId}">
	              <div class="comment-menu-item">
	                <i class="fa fa-flag"></i> ì‹ ê³ 
	              </div>
	            </div>
	          </div>
	            </div>
	          `;
	          commentsList.insertAdjacentHTML('beforeend', commentHTML);
	        });
	        $(".comments-profile-content").off('click', '.comments-icon').on('click', '.comments-icon', function(event){
	        	  let data = $(this).closest(".comments-profile-content").data("comment-id");
	        	  let userId = $(this).closest(".comments-profile-content").data("comment-userid");
	        	  let myUserId = $(".userId").data("user-id");
				console.log("userId :"+userId);
				console.log("myUserId :"+myUserId);
	        	  if (userId === myUserId) {
	        	    $(".comment-menu-item").html(`
	        	      <button class="edit-btn">
	        	        <i class="icon">âœï¸</i> ìˆ˜ì •
	        	      </button>
	        	      <button class="delete-btn">
	        	        <i class="icon">ğŸ—‘ï¸</i> ì‚­ì œ
	        	      </button>
	        	    `);
	        	  }

	        	  if (data) {
	        	    // ëª¨ë“  ë©”ë‰´ ìˆ¨ê¸°ê¸°
	        	    $(".comment-menu").hide();
	        	    // í•´ë‹¹ data ê°’ì— ë§ëŠ” ë©”ë‰´ë§Œ ë³´ì´ë„ë¡
	        	    $(".comment-menu[data-comment-id='" + data + "']").toggle();
	        	  } else {
	        	    alert("No data-comment-id found!");
	        	  }

	        	  // ë©”ë‰´ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë°©ì§€
	        	  event.stopPropagation();
	        	});

	        	// ëŒ“ê¸€ ìˆ˜ì • ë° ì‚­ì œ ì²˜ë¦¬
	        	$(".comment-menu").on('click', '.edit-btn, .delete-btn', function(event) {
	        	  const commentId = $(this).closest('.comment-menu').data('comment-id');

	        	  if ($(this).hasClass('delete-btn')) {
	        	    if (confirm('ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
	        	      fetch(`/comments/delete/${commentId}`, { method: 'DELETE' })
	        	        .then(() => loadComments())
	        	        .catch(err => console.error('ëŒ“ê¸€ ì‚­ì œ ì‹¤íŒ¨:', err));
	        	    }
	        	  }

	        	  if ($(this).hasClass('edit-btn')) {
	        	    const currentText = $(this).closest('.comments-profile-content').find('.comment-text').text();
	        	    const newText = prompt('ìˆ˜ì •í•  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”:', currentText);
	        	    if (newText) {
	        	      fetch(`/comments/update/${commentId}`, {
	        	        method: 'PUT',
	        	        headers: { 'Content-Type': 'application/json' },
	        	        body: JSON.stringify({ body: newText }),
	        	      })
	        	        .then(() => loadComments())
	        	        .catch(err => console.error('ëŒ“ê¸€ ìˆ˜ì • ì‹¤íŒ¨:', err));
	        	    }
	        	  }
	        	});
			// ë©”ë‰´ ë°”ê¹¥ì„ í´ë¦­í•˜ë©´ ìˆ¨ê¸°ê¸°
			$(document).on("click", function() {
			    $(".comment-menu").hide();
			});

			// ë©”ë‰´ í´ë¦­ ì‹œ ìˆ¨ê¹€ ë°©ì§€
			$(".comment-menu").on("click", function(event) {
			    event.stopPropagation();
			});
	        // ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬ (AJAX í¬í•¨)
	        $('.comments-profile-content').off('click', '.like-btn').on('click', '.like-btn', function() {
	          const likeButton = $(this);
	          const likeCountElement = likeButton.find('.like-count');
	          let likeCount = parseInt(likeCountElement.text());
	          const liked = likeButton.data('liked');  // ì¢‹ì•„ìš” ìƒíƒœ í™•ì¸

	          if (liked) {
	            // ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ì§€ ì•Šì•˜ë‹¤ë©´ ì¢‹ì•„ìš” ì¶”ê°€ (1 ì¦ê°€)
	            likeCount += 1;
	            likeButton.data('liked', false); // ì¢‹ì•„ìš” ì·¨ì†Œ ìƒíƒœë¡œ ë³€ê²½
	          } else {
	            
	            likeCount -= 1;
	            likeButton.data('liked', true); // ì¢‹ì•„ìš” ìƒíƒœë¡œ ë³€ê²½
	          }
	       // ì´ë¯¸ ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ë‹¤ë©´ ì¢‹ì•„ìš” ì·¨ì†Œ (1 ê°ì†Œ)
	          likeCountElement.text(likeCount); // ì¢‹ì•„ìš” ìˆ˜ ì—…ë°ì´íŠ¸
	          const commentId = likeButton.closest('.comments-profile-content').data('commentId');
	          updateLikeDislikeCount(commentId, likeCount, likeButton.data('liked'));
	        });

	        // ì‹«ì–´ìš” ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬ (AJAX í¬í•¨)
	        $('.comments-profile-content').off('click', '.dislike-btn').on('click', '.dislike-btn', function() {
	          // ì‹«ì–´ìš” ë²„íŠ¼ì˜ ë™ì‘ì´ ì—†ìœ¼ë¯€ë¡œ ë”°ë¡œ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
	        });
	      })
	      .catch(err => console.error('ëŒ“ê¸€ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:', err));
	  }

	  // ì¢‹ì•„ìš”/ì‹«ì–´ìš” ìˆ˜ë¥¼ ì„œë²„ì— ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜ (AJAX ìš”ì²­)
	  function updateLikeDislikeCount(commentId, newLikeCount, liked) {
	    $.ajax({
	      url: '/comments/update-likes',
	      method: 'POST',
	      contentType: 'application/json',
	      data: JSON.stringify({
	        commentId: commentId,
	        likeCount: newLikeCount,
	        liked: liked  // ì¢‹ì•„ìš” ìƒíƒœ ì „ë‹¬
	      }),
	      success: function(response) {
	        console.log('ì„œë²„ì—ì„œ ì‘ë‹µë°›ì€ ë°ì´í„°:', response);
	      },
	      error: function(err) {
	        console.error('ì„œë²„ì— ì¢‹ì•„ìš”/ì‹«ì–´ìš” ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', err);
	      }
	    });
	  }

	  commentSubmitBtn.addEventListener('click', () => {
	    const commentText = commentInput.value.trim();
	    if (commentText) {
	      fetch('/comments/create', {
	        method: 'POST',
	        headers: { 'Content-Type': 'application/json' },
	        body: JSON.stringify({
	          body: commentText,
	          nickName: userNickname,
	          profileImage: userProfile,
	          wetubeId: wetubeId,
	          userId:userId
	        }),
	      })
	        .then(() => {
	          commentInput.value = '';
	          loadComments();
	        })
	        .catch(err => console.error('ëŒ“ê¸€ ë“±ë¡ ì‹¤íŒ¨:', err));
	    }
	  });

	  loadComments(); // ì´ˆê¸° ë¡œë“œ

	  // ë¹„ë””ì˜¤ ê´€ë ¨ ê¸°ëŠ¥
	  $(".video-thumbnail-container").click(function () {
	    let id = $(this).closest(".id_videos").data("id");
	    location = "/watch?id=" + id;
	  });

	  $(".none-profile").click(function(){
	    location = "/login";
	  });
	  $('.wt-bl').on('click', function () {
		    const container = $(this);  // í´ë¦­í•œ ë²„íŠ¼ì˜ ìš”ì†Œ
		    const likesCountElement = container.find('.likes-count');  // ì¢‹ì•„ìš” ìˆ˜ í‘œì‹œ
		    let currentLikes = parseInt(likesCountElement.text());  // í˜„ì¬ ì¢‹ì•„ìš” ìˆ˜
		    const isLiked = container.hasClass('liked');  // ì´ë¯¸ ì¢‹ì•„ìš”ê°€ ëˆŒë¦° ìƒíƒœì¸ì§€ í™•ì¸

		    // ìƒíƒœì— ë”°ë¼ ì¢‹ì•„ìš” ìˆ˜ë¥¼ ì¦ê°€ ë˜ëŠ” ê°ì†Œ
		    const newLikes = isLiked ? currentLikes - 1 : currentLikes + 1;

		    // ì¢‹ì•„ìš” ìƒíƒœ í† ê¸€ (í´ë˜ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ìƒíƒœ ë³€ê²½)
		    container.toggleClass('liked');

		    // AJAXë¡œ ì„œë²„ì— ìƒˆë¡œìš´ ì¢‹ì•„ìš” ìˆ˜ ë³´ë‚´ê¸°
		    $.ajax({
		        url: '/like',
		        method: 'POST',
		        contentType: 'application/json',
		        data: JSON.stringify({
		            id: container.data('id'),
		            liked: !isLiked  // ì¢‹ì•„ìš” ìƒíƒœ (true: ì¢‹ì•„ìš”, false: ì·¨ì†Œ)
		        }),
		        success: function (response) {
		            likesCountElement.text(response);  // ì„œë²„ë¡œë¶€í„° ì‘ë‹µë°›ì€ ì¢‹ì•„ìš” ìˆ˜ë¡œ ì—…ë°ì´íŠ¸
		        },
		        error: function () {
		            alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
		        }
		    });
		});
	  $('.wt-bl-share').on('click', function () {
		    const url = window.location.href; // í˜„ì¬ í˜ì´ì§€ URLì„ ê°€ì ¸ì˜´

		    // í´ë¦½ë³´ë“œì— URL ë³µì‚¬í•˜ê¸°
		    navigator.clipboard.writeText(url).then(() => {
		        alert("URLì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
		    }).catch(err => {
		        console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨", err);
		        alert("URL ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
		    });
		});
	$
		    $('.video-thumbnail-container').each(function () {
    const $container = $(this);
    const $video = $container.find('video');
    const $durationEl = $container.find('.video-duration');

    // ë©”íƒ€ë°ì´í„° ë¡œë“œ í›„ ê¸¸ì´ í‘œì‹œ
    $video.on('loadedmetadata', function () {
      const duration = this.duration;
      const minutes = Math.floor(duration / 60);
      const seconds = Math.floor(duration % 60);
      $durationEl.text(`${minutes}:${seconds < 10 ? '0' : ''}${seconds}`);
    });
  });
	$(".profile-container img,.profile-info b").click(function(){
		let id=$(".profile-container").data("user-id");
		 location ="/channel?id="+id;
	});
	//ìˆ˜ì • ë¶€ë¶„ 
	$(".btn-outline-success").click(function(){
	    const urlParams = new URLSearchParams(window.location.search);
	    const id = urlParams.get('id');
	    
	    location = "/updateVideo?id="+id;
	});
	$(".btn-outline-danger").click(function(){
	    const urlParams = new URLSearchParams(window.location.search);
	    const id = urlParams.get('id');  // URLì—ì„œ id ê°’ì„ ê°€ì ¸ì˜´

	    fetch('/api/videos', {
	        method: 'DELETE',
	        headers: {
	            'Content-Type': 'application/json',  // JSON í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡
	        },
	        body: JSON.stringify({ id: id })  // id ê°’ì„ JSON í˜•ì‹ìœ¼ë¡œ ìš”ì²­ ë³¸ë¬¸ì— ì¶”ê°€
	    })
	    .then(response => {
	        if (response.ok) {
	            alert("ì˜ìƒì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
	            // ì„±ê³µ ì‹œ ë¦¬ë‹¤ì´ë ‰ì…˜ ë˜ëŠ” ì¶”ê°€ ì‘ì—…
	            window.location.href = '/';  // ì˜ˆì‹œ: ì˜ìƒ ëª©ë¡ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
	        } else {
	            alert("ì˜ìƒ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
	        }
	    })
	    .catch(error => {
	        console.error("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
	        alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
	    });
	    
	});//ì‚­ì œ ë²„íŠ¼ ë
	});
</script>
<!-- ê´‘ê³  ì˜ìƒ ì²˜ë¦¬ ë¶€ë¶„ -->
<script>
$(document).ready(function () {
    let adPlayer = $("#adPlayer");
    let mainPlayer = $("#mainPlayer");
    let skipButton = $("#skipButton");

    // ëœë¤ ê´‘ê³  ëª©ë¡
    let ads = [
        "/video/ë¹™ê·¸ë ˆ ë°”ë‚˜ë‚˜ë§› ìš°ìœ  ê´‘ê³ .mp4",
        "/video/ì•¼ë‚˜ë‘.mp4",
        "/video/youtube_9lFgBrA2SIU_1920x1080_h264.mp4",
        "/video/youtube_n_PAk9ERzWw_1920x1080_h264.mp4",
        "/video/youtube_tuUKeM5Ocso_1920x1080_h264.mp4"
    ];

    // ê´‘ê³ ë¥¼ ëœë¤ìœ¼ë¡œ ì„ íƒ
    let randomAd = ads[Math.floor(Math.random() * ads.length)];
    $("#adSource").attr("src", randomAd);
    adPlayer[0].load(); // ë¹„ë””ì˜¤ ì†ŒìŠ¤ ë¡œë“œ

    // ê´‘ê³  ëë‚˜ë©´ ë³¸ ì˜ìƒìœ¼ë¡œ ì „í™˜
    adPlayer.on("ended", function () {
        $(".ad-wrapper").hide(); // ê´‘ê³  ê°ì‹¸ëŠ” div ìˆ¨ê¸°ê¸°
        mainPlayer.show().trigger("play"); // ë³¸ ì˜ìƒ ì¬ìƒ
    });

    // 5ì´ˆ í›„ ìŠ¤í‚µ ë²„íŠ¼ í‘œì‹œ
    setTimeout(function () {
        skipButton.show();
    }, 5000);

    // ìŠ¤í‚µ ë²„íŠ¼ í´ë¦­ ì‹œ ê´‘ê³  ê±´ë„ˆë›°ê¸°
    skipButton.on("click", function () {
        adPlayer.get(0).pause();
        $(".ad-wrapper").hide(); // ê´‘ê³  ìˆ¨ê¸°ê¸°
        mainPlayer.show().trigger("play"); // ë³¸ ì˜ìƒ ì¬ìƒ
    });
});
</script>
</head>
<body>
	<section layout:fragment="content">
		<div class="video-tabs-container">
			<div class="video-container">
			    <!-- ê´‘ê³ ìš© ë¹„ë””ì˜¤ -->
			       <div class="ad-wrapper">
			    <video id="adPlayer" class="ad-video" autoplay>
			        <source id="adSource" type="video/mp4">
			    </video>
		        <!-- ìœ íŠœë¸Œ ìŠ¤íƒ€ì¼ ìŠ¤í‚µ ë²„íŠ¼ -->
		        <button id="skipButton" class="skip-ad-btn" style="display: none;">ê´‘ê³  ê±´ë„ˆë›°ê¸°</button>
				</div>
			    <!-- ì›ë˜ ì˜ìƒ (ê¸°ì¡´ video íƒœê·¸ ìœ ì§€) -->
			    <video th:src="@{${view.saved_path}}" controls id="mainPlayer" style="display: none;"></video>
			</div>
			<!-- ìš°ì¸¡ ë¶€ë¶„ -->
			<div class="videos">
				<ul class="nav nav-pills">
					<li class="nav-item"><a class="nav-link active" data-toggle="pill" href="#home">ì „ì²´</a></li>
					<li class="nav-item"><a class="nav-link" data-toggle="pill" href="#menu1">ê´€ë ¨ ì»¨í…ì¸ </a></li>
				</ul>
				<div class="id_videos" th:each="video : ${list}" th:data-id="${video.id}">
				<div class="video-thumbnail-container">
					  <!-- ë™ì˜ìƒ ì¸ë„¤ì¼ -->
       			 <video  preload="metadata" th:src="@{${video.saved_path}+'#t=2.0'}"></video>
					<span class="video-duration">0:00</span>
				</div>
				<div class="details">
					<div class="videos-title-container">
						<p class="videos-title"  th:text="${video.title}"></p>
						<i class="fa fa-ellipsis-v videos-icon float-right"></i>
					</div>
					<p class="videos-UserName" th:text="${video.userNickname}"></p>
					<p class="vidoes-UserHit" th:text="'ì¡°íšŒìˆ˜'+${video.hit}+'íšŒ'"></p>
				</div>
				</div>
			</div>
		</div>
		<div class="watch-videos">
		<div class="watch-title" th:text="${view.title}">
		</div>

		<!-- í”„ë¡œí•„, êµ¬ë… ë²„íŠ¼ ë“± -->
		<div class="watch-content">
			<div class="profile-container" th:data-user-id="${view.user_id}">
				<img th:src="@{${view.userProfile}}" alt="Profile" class="profile-image">
				<div class="profile-info">
					<b class="watch-UserName" th:text="${view.userNickname}"></b>
					<p class="subscriber-count" th:text="'êµ¬ë…ì ' + ${view.userSubscriber} + 'ëª…'"></p>
				</div>
				<div th:if="${isValidToken}">
				<div th:if="${user.id} != ${view.user_id}">
				<button class="subscribe-btn">êµ¬ë…</button>
				</div>
				<div th:if="${user.id} == ${view.user_id}">
				<button class="btn btn-outline-success" style="width: 70px; height: 50px; font-size:12px;">ë™ì˜ìƒ ìˆ˜ì •</button>
				<button class="btn btn-outline-danger" style="width: 70px; height: 50px; font-size:12px;">ë™ì˜ìƒ ì‚­ì œ</button>
				</div>
				
				</div>
				<div th:unless="${isValidToken}">
				<button class="subscribe-btn">êµ¬ë…</button>
				</div>
				<!-- user id ì²˜ë¦¬ë¶€ë¶„ -->
				<div th:unless="${user == null or user.id == null}">
				    <div class="userId" th:data-user-id="${user.id}" style="display: none"></div>
				</div>
			</div>
			<div class="like-dislike-btns">
				<div class="wt-bl" th:data-id="${view.id}">
				<i class="fa fa-thumbs-up like-dislike-btn"></i>
				<span class="likes-count" th:text="${view.likes}"></span>
				</div>
				<div class="wt-bl-rt">
				<i class="fa fa-thumbs-down like-dislike-btn"></i>
				</div>
				<div class="wt-bl-share">
				<i class="fa fa-share share-save-btn"></i>
				<span >ê³µìœ </span>
				</div>
				<div class="wt-bl-save">
				<i class="fa fa-save share-save-btn"></i>
				<span>ì €ì¥</span>
				</div>
			</div>
			
		</div>
			<div class="video-details" >
				<p class="views-count" th:text="'ì¡°íšŒìˆ˜'+${view.hit}+'íšŒ'"></p>
				<p class="date" th:text="${#temporals.format(view.createdAt, 'yyyyë…„ MMì›” ddì¼')}"></p>
				<div class="ellipsis" th:text="${view.content}"></div>
			</div>
			<!-- ëŒ“ê¸€ ì „ì²´ ì»¨í…Œì´ë„ˆ -->
			<div class="comments-container">
			  <div class="comments-count">ëŒ“ê¸€ 10ê°œ</div>
			  <div class="comments-sorting">
			    <i class="material-icons" style="font-size:36px;">sort</i>
			    <div class="comments-font">ì •ë ¬ ê¸°ì¤€</div>
			  </div>
			</div>
			
			<!-- ëŒ“ê¸€ ì…ë ¥ ë¶€ë¶„ -->
			<div class="comments-profile-container">
			<div th:if="${user != null}">
			  <img th:src="@{${user.profile}}" alt="Profile" class="profile-image">
			  <input type="text" class="comment-input" placeholder="ëŒ“ê¸€ ì¶”ê°€...">
			  <input type="hidden" id="user-nickname" th:value="${user.nickname}">
			  <input type="hidden" id="user-wetubeId" th:value="${view.id}">
			  <button class="comment-submit-btn">ë“±ë¡</button>
			  </div>
			</div>
			<div class="comments-profile-container none-profile">
			  <div th:unless="${user}">
			  <img src="/upload/basic.png" alt="Profile" class="profile-image">
			  <input type="text" class="comment-input" placeholder="ëŒ“ê¸€ ì¶”ê°€...">
			  <input type="hidden" id="user-wetubeId"  th:value="${view.id}">
			   <input type="hidden" id="user-nickname" value=null>
			   <button class="comment-submit-btn" style="display: none;"></button>
			  </div>	
			  </div>		
			<!-- ëŒ“ê¸€ ë¦¬ìŠ¤íŠ¸ -->
			<div id="comments-list">
			  <div class="comments-profile-content" data-comment-id="1">
			    <img src="/upload/rabbit.jpg" alt="Profile" class="profile-image">
			    <div class="comment-content">
			      <p class="comment-author"></p>
			      <p class="comment-text"></p>
			      <div class="comment-actions">
			        <button class="action-button like-btn"><i class="fa fa-thumbs-up"></i> </button>
			        <button class="action-button dislike-btn"><i class="fa fa-thumbs-down"></i></button>
			      </div>
			    </div>
			    <i class="fa fa-ellipsis-v videos-icon comments-icon" ></i>
			  </div>
			</div>
			</div>
	</section>
</body>
</html>
